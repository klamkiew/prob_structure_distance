%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.16
%%CreationDate: Thu Nov 12 11:42:15 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  % draw strand separators if required
  currentdict /nicks known {
    gsave
    % draw lines in red color
    0 1 1 sethsbcolor
    % draw with line thickness of 0.2
    0.2 setlinewidth
    nicks
    { 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
    } forall
    grestore
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (structure02)
} def

/sequence { (\
CGGCACGCUUCAGACCUAUUAGUUUUACGUAAUAUUCGGAACGAUCUAGCCGACGAAAAAACUCUU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.006491465 ubox
1 13 0.004422749 ubox
1 29 0.011024270 ubox
1 49 0.003323402 ubox
1 52 0.975033043 ubox
1 55 0.025101607 ubox
2 6 0.006475164 ubox
2 8 0.009068952 ubox
2 9 0.007698082 ubox
2 11 0.010678891 ubox
2 15 0.005013830 ubox
2 16 0.069693152 ubox
2 17 0.009922309 ubox
2 28 0.011521795 ubox
2 33 0.003494637 ubox
2 46 0.006244263 ubox
2 47 0.015778317 ubox
2 51 0.994810767 ubox
2 54 0.023592517 ubox
2 64 0.003766920 ubox
3 8 0.008219704 ubox
3 10 0.008453730 ubox
3 15 0.069735401 ubox
3 16 0.010468870 ubox
3 45 0.005809193 ubox
3 46 0.016721011 ubox
3 50 0.994863101 ubox
3 54 0.004408431 ubox
4 13 0.059842008 ubox
4 49 0.993760072 ubox
4 52 0.008485167 ubox
5 9 0.003203704 ubox
5 10 0.004356619 ubox
5 23 0.010227970 ubox
5 25 0.008570331 ubox
5 30 0.106132626 ubox
5 45 0.325018952 ubox
5 47 0.319269413 ubox
6 13 0.053620907 ubox
6 22 0.010935098 ubox
6 29 0.111177992 ubox
6 38 0.006906219 ubox
6 43 0.799944072 ubox
6 49 0.005736703 ubox
6 52 0.007971904 ubox
6 55 0.004086823 ubox
7 11 0.014006455 ubox
7 15 0.013510569 ubox
7 16 0.013798983 ubox
7 23 0.032921165 ubox
7 28 0.110605425 ubox
7 30 0.050472407 ubox
7 37 0.007168406 ubox
7 42 0.802789431 ubox
7 45 0.101564467 ubox
7 46 0.260334825 ubox
7 47 0.057603406 ubox
7 50 0.025097987 ubox
7 51 0.005995203 ubox
7 54 0.004055209 ubox
8 13 0.018689979 ubox
8 22 0.034726505 ubox
8 29 0.052035587 ubox
8 39 0.011345450 ubox
8 43 0.350840399 ubox
8 49 0.026031921 ubox
9 13 0.003410417 ubox
9 14 0.004988157 ubox
9 18 0.004565728 ubox
9 21 0.034254590 ubox
9 27 0.050915570 ubox
9 38 0.011120509 ubox
9 39 0.004007629 ubox
9 40 0.340810355 ubox
9 41 0.824099347 ubox
9 43 0.018235546 ubox
9 44 0.087527601 ubox
9 48 0.025852400 ubox
9 57 0.006905997 ubox
10 27 0.044488705 ubox
10 34 0.003227108 ubox
10 38 0.003719607 ubox
10 39 0.344171082 ubox
10 40 0.838436100 ubox
10 41 0.018748024 ubox
10 43 0.078099434 ubox
10 44 0.319551949 ubox
10 48 0.010799339 ubox
10 56 0.007651966 ubox
11 22 0.005160618 ubox
11 29 0.004232564 ubox
11 38 0.340150475 ubox
11 39 0.833562954 ubox
11 43 0.322005924 ubox
11 55 0.007719587 ubox
12 17 0.004437532 ubox
12 19 0.011264355 ubox
12 20 0.004496456 ubox
12 24 0.006351655 ubox
12 25 0.127524930 ubox
12 26 0.014596265 ubox
12 35 0.006458328 ubox
12 36 0.038579797 ubox
12 45 0.004303994 ubox
12 47 0.031351636 ubox
12 65 0.007736870 ubox
13 17 0.003549665 ubox
13 19 0.003978726 ubox
13 20 0.009241217 ubox
13 23 0.005190683 ubox
13 24 0.142718005 ubox
13 25 0.015674648 ubox
13 35 0.038782991 ubox
13 36 0.164134311 ubox
13 37 0.830082433 ubox
13 42 0.087646110 ubox
13 46 0.032673566 ubox
13 64 0.008270413 ubox
14 19 0.008420659 ubox
14 20 0.003583283 ubox
14 23 0.144609868 ubox
14 24 0.014770607 ubox
14 30 0.017373535 ubox
14 35 0.161525439 ubox
14 36 0.819049517 ubox
14 45 0.031999893 ubox
14 63 0.006974957 ubox
15 22 0.144114641 ubox
15 29 0.018576030 ubox
15 38 0.071253905 ubox
15 39 0.342061077 ubox
15 43 0.006631308 ubox
16 22 0.020891909 ubox
16 29 0.003751500 ubox
16 38 0.342439179 ubox
16 39 0.028178532 ubox
16 43 0.012838936 ubox
16 49 0.005401209 ubox
17 21 0.021761943 ubox
17 27 0.018391615 ubox
17 31 0.027443518 ubox
17 32 0.008146172 ubox
17 34 0.932590824 ubox
17 38 0.024498126 ubox
17 48 0.009884056 ubox
18 24 0.003196924 ubox
18 25 0.004532290 ubox
18 26 0.018531128 ubox
18 30 0.028411770 ubox
18 33 0.965889245 ubox
18 35 0.034846588 ubox
18 36 0.044233150 ubox
18 45 0.013394468 ubox
18 47 0.009599905 ubox
18 65 0.003690477 ubox
18 66 0.017715845 ubox
19 29 0.027206028 ubox
19 31 0.033988060 ubox
19 32 0.969646808 ubox
19 34 0.032330285 ubox
19 40 0.003699005 ubox
19 44 0.015712192 ubox
20 27 0.015813442 ubox
20 29 0.010907664 ubox
20 31 0.969104579 ubox
20 32 0.005977382 ubox
20 34 0.055592966 ubox
20 39 0.003482362 ubox
20 43 0.014083338 ubox
20 44 0.006683223 ubox
20 48 0.023251411 ubox
21 26 0.015925307 ubox
21 30 0.959088695 ubox
21 33 0.052091072 ubox
21 35 0.014546911 ubox
21 36 0.013062028 ubox
21 47 0.023840687 ubox
21 63 0.072444912 ubox
21 65 0.003343017 ubox
22 26 0.009610026 ubox
22 28 0.455413466 ubox
22 30 0.010773106 ubox
22 33 0.058724946 ubox
22 35 0.016176505 ubox
22 37 0.008458918 ubox
22 42 0.043893739 ubox
22 45 0.005948350 ubox
22 46 0.023734363 ubox
22 62 0.078126284 ubox
22 64 0.003480649 ubox
23 27 0.411462701 ubox
23 29 0.046990981 ubox
23 31 0.016963692 ubox
23 32 0.064538080 ubox
23 34 0.016023465 ubox
23 41 0.043765625 ubox
23 44 0.012732113 ubox
23 59 0.009156214 ubox
23 60 0.017089857 ubox
23 61 0.076859600 ubox
24 29 0.018950035 ubox
24 31 0.063951964 ubox
24 32 0.018917110 ubox
24 40 0.043037986 ubox
24 41 0.008067151 ubox
24 43 0.012470168 ubox
24 44 0.012083139 ubox
24 58 0.011825207 ubox
24 59 0.022563276 ubox
24 60 0.075196034 ubox
25 29 0.012216212 ubox
25 31 0.019600028 ubox
25 32 0.012541789 ubox
25 34 0.008121525 ubox
25 39 0.040572495 ubox
25 40 0.010486805 ubox
25 41 0.016767845 ubox
25 43 0.011213204 ubox
25 57 0.013482575 ubox
25 58 0.026509646 ubox
25 59 0.072870305 ubox
26 31 0.012087886 ubox
26 32 0.003752796 ubox
26 34 0.006395800 ubox
26 38 0.023826820 ubox
26 39 0.010418894 ubox
26 40 0.011177394 ubox
26 41 0.004993589 ubox
26 44 0.006983373 ubox
26 48 0.003656647 ubox
26 56 0.014725022 ubox
26 57 0.028470307 ubox
26 58 0.067094972 ubox
27 33 0.006502636 ubox
27 36 0.005182390 ubox
27 45 0.004435278 ubox
27 47 0.003720254 ubox
28 38 0.066870866 ubox
28 39 0.006419595 ubox
28 43 0.038613414 ubox
28 52 0.003720100 ubox
28 55 0.077011769 ubox
29 35 0.011442762 ubox
29 36 0.006481267 ubox
29 37 0.067975335 ubox
29 42 0.039598441 ubox
29 51 0.003688713 ubox
29 54 0.077400670 ubox
29 62 0.005825796 ubox
30 34 0.010977402 ubox
30 41 0.038481450 ubox
30 48 0.005530540 ubox
30 53 0.058859479 ubox
30 56 0.005309040 ubox
30 61 0.005667046 ubox
31 35 0.008056609 ubox
31 36 0.013018482 ubox
31 47 0.006482983 ubox
32 45 0.004116924 ubox
32 47 0.007318305 ubox
33 38 0.010568813 ubox
33 39 0.004171558 ubox
33 40 0.005065430 ubox
33 44 0.003183577 ubox
33 48 0.032597061 ubox
33 56 0.006291152 ubox
34 45 0.016768445 ubox
34 47 0.032942324 ubox
35 41 0.003323715 ubox
35 44 0.016168235 ubox
35 48 0.012055705 ubox
35 49 0.009574377 ubox
35 53 0.003837084 ubox
35 57 0.021215937 ubox
36 40 0.003347801 ubox
36 43 0.012655836 ubox
36 44 0.113228732 ubox
36 48 0.015298165 ubox
36 49 0.005979066 ubox
36 53 0.066146381 ubox
36 56 0.023077384 ubox
37 43 0.120551008 ubox
37 49 0.004724933 ubox
37 52 0.080554395 ubox
37 55 0.023265925 ubox
38 42 0.112975831 ubox
38 45 0.005155839 ubox
38 46 0.017238530 ubox
38 47 0.102515549 ubox
38 51 0.080651588 ubox
38 54 0.023170791 ubox
39 45 0.012696186 ubox
39 46 0.109106326 ubox
39 50 0.080386191 ubox
40 45 0.099771046 ubox
40 47 0.008440937 ubox
41 45 0.003919783 ubox
41 47 0.006412793 ubox
42 49 0.041048431 ubox
42 52 0.014855966 ubox
42 55 0.005664914 ubox
43 47 0.004928057 ubox
43 50 0.004750851 ubox
43 51 0.014928651 ubox
43 54 0.005836775 ubox
45 53 0.007329267 ubox
45 56 0.005094687 ubox
46 52 0.007635225 ubox
46 55 0.005449788 ubox
52 62 0.007496041 ubox
52 64 0.040115208 ubox
52 66 0.015378857 ubox
53 63 0.040496626 ubox
53 65 0.040502923 ubox
53 66 0.043698922 ubox
55 62 0.091695476 ubox
55 63 0.011713627 ubox
55 64 0.391967926 ubox
55 65 0.009157026 ubox
55 66 0.039688163 ubox
56 63 0.376151542 ubox
56 65 0.043497063 ubox
56 66 0.021705469 ubox
57 63 0.021254895 ubox
57 65 0.024018057 ubox
57 66 0.032932029 ubox
58 63 0.019589919 ubox
58 65 0.036181855 ubox
58 66 0.025214675 ubox
59 63 0.009953015 ubox
59 65 0.028342830 ubox
59 66 0.029374987 ubox
60 65 0.030739804 ubox
60 66 0.017526676 ubox
61 65 0.016064753 ubox
61 66 0.009653153 ubox
1 52 0.9500000 lbox
2 51 0.9500000 lbox
3 50 0.9500000 lbox
4 49 0.9500000 lbox
6 43 0.9500000 lbox
7 42 0.9500000 lbox
9 41 0.9500000 lbox
10 40 0.9500000 lbox
11 39 0.9500000 lbox
13 37 0.9500000 lbox
14 36 0.9500000 lbox
17 34 0.9500000 lbox
18 33 0.9500000 lbox
19 32 0.9500000 lbox
20 31 0.9500000 lbox
21 30 0.9500000 lbox
showpage
end
%%EOF
